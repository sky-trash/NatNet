import{_ as k,a as M,H as N}from"./index-C8RauV5e.js";import{c as _,a as l,b as e,n as m,t as c,k as W,r as f,o as B,i as w,F as H,j as R}from"./index-D9HbOK_w.js";const d="/sprite.svg",q={name:"City",setup(){const n=W(),t=f({city:"Загрузка...",precipitation:"Загрузка...",degree_text:"--°",degree_img:"",pressure:"--",sunset:"--:--"}),i=f(!1),s="bcd77d629ed5dea3ac2bc630f5b390b7",p=a=>a.charAt(0).toUpperCase()+a.slice(1),g=()=>{const a=JSON.parse(localStorage.getItem("favoriteCities")||"[]");i.value=a.some(r=>r.name===t.value.city)},u=a=>{a.stopPropagation();const r=JSON.parse(localStorage.getItem("favoriteCities")||"[]"),h=r.findIndex(o=>o.name===t.value.city);h===-1?r.push({name:t.value.city,temp:t.value.degree_text,icon:t.value.degree_img,lat:n.query.lat,lon:n.query.lon}):r.splice(h,1),localStorage.setItem("favoriteCities",JSON.stringify(r)),i.value=!i.value},b=async()=>{try{const{lat:a,lon:r}=n.query,o=(await M.get("https://api.openweathermap.org/data/2.5/weather",{params:{lat:a,lon:r,appid:s,units:"metric",lang:"ru"}})).data,v=new Date(o.sys.sunset*1e3),y=v.getHours().toString().padStart(2,"0"),x=v.getMinutes().toString().padStart(2,"0"),C=S=>{const F={"01":"Clear","02":"Clouds","03":"Clouds","04":"Clouds","09":"Rain",10:"Rain",11:"Rain",13:"Snow",50:"weather"},I=S.replace(/(d|n)$/,"");return F[I]||"weather"};t.value={city:o.name,precipitation:p(o.weather[0].description),degree_text:`${Math.round(o.main.temp)}°`,degree_img:`/weather/${C(o.weather[0].icon)}.svg`,pressure:Math.round(o.main.pressure*.750064),sunset:`${y}:${x}`},g()}catch(a){console.error("Ошибка при получении данных о погоде:",a),t.value.city="Ошибка загрузки"}};return B(()=>{b()}),{weather:t,isFavorite:i,toggleFavorite:u}}},D=d+"#chevron-left",J=d+"#bookmark-back",O=d+"#bookmark-fill",z=d+"#barometer",A={class:"background"},E={class:"back"},L={class:"back__right"},P={class:"weather"},V={class:"weather__city"},j={class:"weather__precipitation"},K={class:"weather__degree"},T={class:"weather__degree_text"},U={class:"weather__degree_img"},Y=["src","alt"],G={class:"weather__pressure"},Q={class:"weather__pressure_text"},X={class:"weather__sunset"};function Z(n,t,i,s,p,g){return l(),_("div",A,[e("div",E,[t[3]||(t[3]=e("a",{href:"/",class:"back-link"},[e("div",{class:"back__left"},[e("div",{class:"back__left_img"},[e("svg",{class:"icon chevron-icon"},[e("use",{href:D})])]),e("div",{class:"back__left_text"},[e("h1",null,"Назад")])])],-1)),e("div",L,[e("button",{onClick:t[0]||(t[0]=(...u)=>s.toggleFavorite&&s.toggleFavorite(...u)),class:"favorite-btn"},[(l(),_("svg",{class:m(["icon bookmark-icon",{hidden:s.isFavorite}])},t[1]||(t[1]=[e("use",{href:J},null,-1)]),2)),(l(),_("svg",{class:m(["icon bookmark-fill-icon",{hidden:!s.isFavorite}])},t[2]||(t[2]=[e("use",{href:O},null,-1)]),2))])])]),e("div",P,[e("div",V,[e("h1",null,c(s.weather.city),1)]),e("div",j,[e("p",null,c(s.weather.precipitation),1)]),e("div",K,[e("div",T,[e("h1",null,c(s.weather.degree_text),1)]),e("div",U,[e("img",{src:s.weather.degree_img,alt:s.weather.precipitation},null,8,Y)])]),e("div",G,[t[4]||(t[4]=e("div",{class:"weather__pressure_img"},[e("svg",{class:"icon pressure-icon"},[e("use",{href:z})])],-1)),e("div",Q,[e("p",null,c(s.weather.pressure)+" мм рт.ст.",1)])]),e("div",X,[e("h1",null,"Закат в "+c(s.weather.sunset),1)])])])}const $=k(q,[["render",Z],["__scopeId","data-v-d2b2910d"]]),ee={__name:"WeatherCard",setup(n){return(t,i)=>(l(),_(H,null,[w(N),w($)],64))}},te=k(ee,[["__scopeId","data-v-5295d245"]]),re={__name:"WeatherCard",setup(n){return(t,i)=>(l(),R(te))}};export{re as default};
