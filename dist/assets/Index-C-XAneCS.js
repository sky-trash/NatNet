import{_ as K,a as Ie,H as we}from"./index-DBWu2Uc3.js";import{u as ve,r as j,o as _e,c as m,a as d,b as v,w as Oe,d as E,v as qe,e as Re,f as Y,g as ge,t as Z,F as O,h as be,i as I,j as pe}from"./index-BKjPKylG.js";import{_ as Ce}from"./weatherCity-q_S7b1x1.js";var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ee(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $,ee;function he(){if(ee)return $;ee=1;function t(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}return $=t,$}var N,te;function $e(){if(te)return N;te=1;var t=typeof w=="object"&&w&&w.Object===Object&&w;return N=t,N}var A,re;function Te(){if(re)return A;re=1;var t=$e(),e=typeof self=="object"&&self&&self.Object===Object&&self,n=t||e||Function("return this")();return A=n,A}var L,ne;function Ne(){if(ne)return L;ne=1;var t=Te(),e=function(){return t.Date.now()};return L=e,L}var G,ae;function Ae(){if(ae)return G;ae=1;var t=/\s/;function e(n){for(var a=n.length;a--&&t.test(n.charAt(a)););return a}return G=e,G}var P,oe;function Le(){if(oe)return P;oe=1;var t=Ae(),e=/^\s+/;function n(a){return a&&a.slice(0,t(a)+1).replace(e,"")}return P=n,P}var B,ie;function ye(){if(ie)return B;ie=1;var t=Te(),e=t.Symbol;return B=e,B}var F,se;function Ge(){if(se)return F;se=1;var t=ye(),e=Object.prototype,n=e.hasOwnProperty,a=e.toString,r=t?t.toStringTag:void 0;function l(i){var f=n.call(i,r),_=i[r];try{i[r]=void 0;var o=!0}catch{}var g=a.call(i);return o&&(f?i[r]=_:delete i[r]),g}return F=l,F}var M,le;function Pe(){if(le)return M;le=1;var t=Object.prototype,e=t.toString;function n(a){return e.call(a)}return M=n,M}var W,ue;function Be(){if(ue)return W;ue=1;var t=ye(),e=Ge(),n=Pe(),a="[object Null]",r="[object Undefined]",l=t?t.toStringTag:void 0;function i(f){return f==null?f===void 0?r:a:l&&l in Object(f)?e(f):n(f)}return W=i,W}var D,ce;function Fe(){if(ce)return D;ce=1;function t(e){return e!=null&&typeof e=="object"}return D=t,D}var V,de;function Me(){if(de)return V;de=1;var t=Be(),e=Fe(),n="[object Symbol]";function a(r){return typeof r=="symbol"||e(r)&&t(r)==n}return V=a,V}var z,fe;function We(){if(fe)return z;fe=1;var t=Le(),e=he(),n=Me(),a=NaN,r=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,i=/^0o[0-7]+$/i,f=parseInt;function _(o){if(typeof o=="number")return o;if(n(o))return a;if(e(o)){var g=typeof o.valueOf=="function"?o.valueOf():o;o=e(g)?g+"":g}if(typeof o!="string")return o===0?o:+o;o=t(o);var s=l.test(o);return s||i.test(o)?f(o.slice(2),s?2:8):r.test(o)?a:+o}return z=_,z}var H,me;function De(){if(me)return H;me=1;var t=he(),e=Ne(),n=We(),a="Expected a function",r=Math.max,l=Math.min;function i(f,_,o){var g,s,c,b,p,T,y=0,U=!1,S=!1,q=!0;if(typeof f!="function")throw new TypeError(a);_=n(_)||0,t(o)&&(U=!!o.leading,S="maxWait"in o,c=S?r(n(o.maxWait)||0,_):c,q="trailing"in o?!!o.trailing:q);function R(u){var h=g,k=s;return g=s=void 0,y=u,b=f.apply(k,h),b}function Se(u){return y=u,p=setTimeout(x,_),U?R(u):b}function ke(u){var h=u-T,k=u-y,X=_-h;return S?l(X,c-k):X}function J(u){var h=u-T,k=u-y;return T===void 0||h>=_||h<0||S&&k>=c}function x(){var u=e();if(J(u))return Q(u);p=setTimeout(x,ke(u))}function Q(u){return p=void 0,q&&g?R(u):(g=s=void 0,b)}function je(){p!==void 0&&clearTimeout(p),y=0,g=T=s=p=void 0}function xe(){return p===void 0?b:Q(e())}function C(){var u=e(),h=J(u);if(g=arguments,s=this,T=u,h){if(p===void 0)return Se(T);if(S)return clearTimeout(p),p=setTimeout(x,_),R(T)}return p===void 0&&(p=setTimeout(x,_)),b}return C.cancel=je,C.flush=xe,C}return H=i,H}var Ve=De();const ze=Ee(Ve),He={class:"search"},Ke={key:0,class:"search__loading"},Ue={key:1,class:"search__error"},Je={key:0,class:"help-text"},Qe={key:2,class:"search__suggestions"},Xe=["onClick"],Ye={__name:"searth",emits:["city-selected"],setup(t,{emit:e}){const n=ve(),a=j(""),r=j([]),l=j(!1),i=j(null),f="bcd77d629ed5dea3ac2bc630f5b390b7";_e(()=>{});const _=ze(async s=>{if(s.length===0){r.value=[];return}try{l.value=!0,i.value=null;const c=await Ie.get("https://api.openweathermap.org/data/2.5/find",{params:{q:s,appid:f,units:"metric",lang:"ru",cnt:5},validateStatus:b=>b<500});if(c.status===401)throw new Error("Неверный API ключ");r.value=c.data?.list||[],!r.value.length&&s.length>=3?i.value="Город не найден":r.value.length||(i.value="Продолжайте ввод...")}catch(c){i.value=c.response?.status===401?"Ошибка авторизации. Проверьте API ключ в .env":"Ошибка соединения с сервером",console.error("API Error:",c)}finally{l.value=!1}},300),o=s=>{s.key==="Enter"&&s.preventDefault(),a.value=s.target.value,_(a.value)},g=s=>{n.push({name:"WeatherCard",params:{id:s.id,name:s.name},query:{lat:s.coord.lat,lon:s.coord.lon}})};return(s,c)=>(d(),m("div",He,[v("form",{class:"search__form",onSubmit:c[2]||(c[2]=Y(()=>{},["prevent"]))},[Oe(v("input",{"onUpdate:modelValue":c[0]||(c[0]=b=>a.value=b),type:"text",name:"text",class:"search__form__input",placeholder:"Укажите город",onInput:o,onKeydown:[o,c[1]||(c[1]=Re(Y(()=>{},["prevent"]),["enter"]))]},null,544),[[qe,a.value]]),l.value?(d(),m("div",Ke,"Поиск городов...")):i.value?(d(),m("div",Ue,[ge(Z(i.value)+" ",1),i.value.includes("API")?(d(),m("p",Je," Проверьте ключ в файле .env ")):E("",!0)])):E("",!0),r.value.length?(d(),m("ul",Qe,[(d(!0),m(O,null,be(r.value,b=>(d(),m("li",{key:b.id,onClick:p=>g(b)},Z(b.name),9,Xe))),128))])):E("",!0)],32)]))}},Ze=K(Ye,[["__scopeId","data-v-d94ebfe6"]]),et={xmlns:"http://www.w3.org/2000/svg",width:"38",height:"32",fill:"none"};function tt(t,e){return d(),m("svg",et,e[0]||(e[0]=[v("path",{fill:"#8A91AB","fill-rule":"evenodd",d:"M3.6 3.7a.5.5 0 0 1 .7-.1l3.6 2.7a.5.5 0 0 1-.6.8L4.693 5.145C7.7 21.508 22.971 29.405 35.91 27.008l.182.984C22.65 30.48 6.771 22.262 3.694 5.242L1.7 7.9a.5.5 0 0 1-.8-.6z","clip-rule":"evenodd"},null,-1)]))}const rt={render:tt},nt={class:"city"},at={__name:"city",setup(t){const e=ve(),n=()=>{const a={lat:56.8527,lon:53.2115};e.push({name:"WeatherCard",params:{name:"Ижевск"},query:{lat:a.lat,lon:a.lon}})};return(a,r)=>(d(),m("div",nt,[r[1]||(r[1]=v("div",{class:"city__img"},[v("img",{src:rt,alt:"arrow"})],-1)),v("div",{class:"city__text"},[v("h1",null,[r[0]||(r[0]=ge("Начните вводить город, например, ",-1)),v("a",{onClick:n,class:"city-link"},"Ижевск")])])]))}},ot=K(at,[["__scopeId","data-v-ad182ff1"]]),it={xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"none"};function st(t,e){return d(),m("svg",it,e[0]||(e[0]=[v("path",{fill:"#8A91AB",d:"M8.333 7.5c0-1.105.41-2.165 1.14-2.946.729-.782 1.718-1.22 2.75-1.22h15.555c1.031 0 2.02.438 2.75 1.22A4.32 4.32 0 0 1 31.667 7.5v28.126c0 .188-.048.373-.139.534-.09.162-.22.294-.375.383a.92.92 0 0 1-.997-.05L20 30.626 9.844 36.493a.919.919 0 0 1-.998.051 1 1 0 0 1-.374-.383 1.1 1.1 0 0 1-.139-.534zm3.89-2.083c-.517 0-1.011.22-1.376.61-.364.39-.57.92-.57 1.473v26.18l9.184-5.171a.93.93 0 0 1 .539-.175c.192 0 .379.061.538.175l9.184 5.17V7.5c0-.552-.205-1.082-.57-1.473a1.88 1.88 0 0 0-1.374-.61z"},null,-1)]))}const lt={render:st},ut={},ct={class:"bookmarks"};function dt(t,e){return d(),m("div",ct,e[0]||(e[0]=[v("div",{class:"bookmarks__content"},[v("div",{class:"bookmarks__content__text"},[v("h1",null,"Используйте значок «закладки», чтобы закрепить город на главной")]),v("div",{class:"bookmarks__content__img"},[v("img",{src:lt,alt:"Закладки"})])],-1)]))}const ft=K(ut,[["render",dt],["__scopeId","data-v-a45d7e1f"]]),mt={key:0,class:"favorites-container"},vt={class:"favorites-container-flex"},_t={__name:"index",setup(t){const e=j([]),n={Москва:{lat:55.7558,lon:37.6176},"Санкт-Петербург":{lat:59.9343,lon:30.3351},Казань:{lat:55.7961,lon:49.1064},Ижевск:{lat:56.8527,lon:53.2115},Грютвикен:{lat:-54.2811,lon:-36.5086}};_e(()=>{const r=localStorage.getItem("favoriteCities");r&&(e.value=JSON.parse(r).map(l=>({...l,lat:l.lat||n[l.name]?.lat||55.7558,lon:l.lon||n[l.name]?.lon||37.6176})))});const a=r=>{const l=e.value.findIndex(i=>i.name===r.name);l===-1?e.value.push({...r,lat:r.lat||n[r.name]?.lat||55.7558,lon:r.lon||n[r.name]?.lon||37.6176}):e.value.splice(l,1),localStorage.setItem("favoriteCities",JSON.stringify(e.value))};return(r,l)=>(d(),m(O,null,[I(we),I(Ze),e.value.length>0?(d(),m("div",mt,[v("div",vt,[(d(!0),m(O,null,be(e.value,i=>(d(),pe(Ce,{key:i.name,city:i.name,temp:i.temp,icon:i.icon,lat:i.lat,lon:i.lon,isFavorite:!0,onToggleFavorite:f=>a(i)},null,8,["city","temp","icon","lat","lon","onToggleFavorite"]))),128))])])):(d(),m(O,{key:1},[I(ot),I(ft)],64))],64))}},ht={__name:"Index",setup(t){return(e,n)=>(d(),pe(_t))}};export{ht as default};
